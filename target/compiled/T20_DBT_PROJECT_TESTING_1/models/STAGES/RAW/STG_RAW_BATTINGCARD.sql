

WITH source_data AS (
    SELECT 
        "MATCHID",
  "INNINGID",
  "PLAYORDER",
  "BATSMANID",
  "DISMISSALTYPEID",
  "BOWLERID",
  "FIELDERID",
  "RUNS",
  "BALLS",
  "BOUNDERIES",
  "SIXES",
  "DOTSBALLS",
  "FILENAME",
  "LOAD_TIMESTAMP",
        CONVERT_TIMEZONE('UTC', CURRENT_TIMESTAMP())::TIMESTAMP_NTZ AS _inserted_at_
    FROM RAUNIT_T20_DBT.T20_RAW.BATTINGSCORECARD
)

SELECT *
FROM source_data


  WHERE _inserted_at_ > (SELECT COALESCE(MAX(_inserted_at_), '1900-01-01') FROM RAUNIT_T20_DBT.T20_DATA_TRANSFORM.STG_RAW_BATTINGCARD)
